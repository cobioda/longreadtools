# longreadtools


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
!pip install git+https://github.com/cobioda/longreadtools.git
```

    Collecting git+https://github.com/cobioda/longreadtools.git
      Cloning https://github.com/cobioda/longreadtools.git to /tmp/pip-req-build-nd3o4s76
      Running command git clone --filter=blob:none --quiet https://github.com/cobioda/longreadtools.git /tmp/pip-req-build-nd3o4s76
      Resolved https://github.com/cobioda/longreadtools.git to commit 73c93ade1ebe317512d46be555619ecfc2200415
      Preparing metadata (setup.py) ... done
    Requirement already satisfied: scanpy in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from longreadtools==0.0.1) (1.9.4)
    Requirement already satisfied: numpy in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from longreadtools==0.0.1) (1.24.4)
    Requirement already satisfied: scipy in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from longreadtools==0.0.1) (1.11.2)
    Requirement already satisfied: pandas in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from longreadtools==0.0.1) (2.1.3)
    Requirement already satisfied: regex in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from longreadtools==0.0.1) (2023.10.3)
    Requirement already satisfied: python-dateutil>=2.8.2 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from pandas->longreadtools==0.0.1) (2.8.2)
    Requirement already satisfied: pytz>=2020.1 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from pandas->longreadtools==0.0.1) (2023.3.post1)
    Requirement already satisfied: tzdata>=2022.1 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from pandas->longreadtools==0.0.1) (2023.3)
    Requirement already satisfied: anndata>=0.7.4 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.10.3)
    Requirement already satisfied: matplotlib>=3.4 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (3.7.2)
    Requirement already satisfied: seaborn in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.12.2)
    Requirement already satisfied: h5py>=3 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (3.9.0)
    Requirement already satisfied: tqdm in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (4.66.1)
    Requirement already satisfied: scikit-learn>=0.24 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (1.3.1)
    Requirement already satisfied: statsmodels>=0.10.0rc2 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.14.0)
    Requirement already satisfied: patsy in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.5.3)
    Requirement already satisfied: networkx>=2.3 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (3.1)
    Requirement already satisfied: natsort in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (8.4.0)
    Requirement already satisfied: joblib in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (1.3.2)
    Requirement already satisfied: numba>=0.41.0 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.57.0)
    Requirement already satisfied: umap-learn>=0.3.10 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (0.5.3)
    Requirement already satisfied: packaging in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (23.1)
    Requirement already satisfied: session-info in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scanpy->longreadtools==0.0.1) (1.0.0)
    Requirement already satisfied: array-api-compat in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from anndata>=0.7.4->scanpy->longreadtools==0.0.1) (1.4)
    Requirement already satisfied: contourpy>=1.0.1 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (1.1.0)
    Requirement already satisfied: cycler>=0.10 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (0.11.0)
    Requirement already satisfied: fonttools>=4.22.0 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (4.42.1)
    Requirement already satisfied: kiwisolver>=1.0.1 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (1.4.5)
    Requirement already satisfied: pillow>=6.2.0 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (10.0.0)
    Requirement already satisfied: pyparsing<3.1,>=2.3.1 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from matplotlib>=3.4->scanpy->longreadtools==0.0.1) (3.0.9)
    Requirement already satisfied: llvmlite<0.41,>=0.40.0dev0 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from numba>=0.41.0->scanpy->longreadtools==0.0.1) (0.40.1)
    Requirement already satisfied: six>=1.5 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from python-dateutil>=2.8.2->pandas->longreadtools==0.0.1) (1.16.0)
    Requirement already satisfied: threadpoolctl>=2.0.0 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from scikit-learn>=0.24->scanpy->longreadtools==0.0.1) (3.2.0)
    Requirement already satisfied: pynndescent>=0.5 in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from umap-learn>=0.3.10->scanpy->longreadtools==0.0.1) (0.5.10)
    Requirement already satisfied: stdlib-list in /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages (from session-info->scanpy->longreadtools==0.0.1) (0.9.0)
    Building wheels for collected packages: longreadtools
      Building wheel for longreadtools (setup.py) ... done
      Created wheel for longreadtools: filename=longreadtools-0.0.1-py3-none-any.whl size=13063 sha256=8176a20415208d42dacb5f4d7f19f2138bb40a07187f65c1b9b4dbd9997eaa49
      Stored in directory: /tmp/pip-ephem-wheel-cache-ctkjx3e0/wheels/97/39/f0/7fa380bf9faac6a2cc85d6ca66b9e893d85e5c72c5eab2d983
    Successfully built longreadtools
    Installing collected packages: longreadtools
    Successfully installed longreadtools-0.0.1

## Install

``` sh
pip install git+https://github.com/cobioda/longreadtools.git
```

## How to use

Here we will use the `isomatrix_tools` module to convert our isomatrix
txt files in bulk into `anndata` objects using the
[`multiple_isomatrix_conversion`](https://cobioda.github.io/longreadtools/isomatrix_tools.html#multiple_isomatrix_conversion)
function . Then, we will utilize our specialized
[`concatenate_anndata`](https://cobioda.github.io/longreadtools/isomatrix_tools.html#concatenate_anndata)
function to generate a concatenated `anndata` for downstream analysis.

``` python
from longreadtools.isomatrix_tools import *
```

``` python
# Importing required libraries
import os
import re

# Defining the directory path
directory = '/data/analysis/data_mcandrew/000-sclr-discovair/'

# Defining the regular expression pattern to match the required files
pattern = re.compile('.*(_BIOP_INT|BIOP_NAS)$')

# Getting a list of all files in the directory
all_files = os.listdir(directory)

# Filtering the list to include only files that match the pattern
matching_files = [os.path.join(directory, f) for f in all_files if pattern.match(f)]

# Printing the list of matching files
print(matching_files)

# Assigning the list of matching files to the variable 'individual_runs'
individual_runs = matching_files

# Adding '_isomatrix.txt' to each file name in the 'individual_runs' list
individual_runs = [f'{run}_isomatrix.txt' for run in individual_runs]

# Creating a list of paths for each isomatrix file in the 'matching_files' list
isomatrix_paths = [os.path.join(run, f'{os.path.basename(run)}_isomatrix.txt') for run in matching_files]
```

    ['/data/analysis/data_mcandrew/000-sclr-discovair/D498_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D492_BIOP_NAS', '/data/analysis/data_mcandrew/000-sclr-discovair/D494_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D500_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D494_BIOP_NAS', '/data/analysis/data_mcandrew/000-sclr-discovair/D496_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D499_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D493_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D493_BIOP_NAS', '/data/analysis/data_mcandrew/000-sclr-discovair/D534_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D490_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D500_BIOP_NAS', '/data/analysis/data_mcandrew/000-sclr-discovair/D495_BIOP_INT', '/data/analysis/data_mcandrew/000-sclr-discovair/D492_BIOP_INT']

``` python
converted_isomatrix_paths = multiple_isomatrix_conversion(isomatrix_paths, verbose=True, return_paths = True, sparse=True)
```

    File /data/analysis/data_mcandrew/000-sclr-discovair/D498_BIOP_INT/D498_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D500_BIOP_NAS/D500_BIOP_NAS_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D500_BIOP_INT/D500_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D493_BIOP_NAS/D493_BIOP_NAS_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D494_BIOP_NAS/D494_BIOP_NAS_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D493_BIOP_INT/D493_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D499_BIOP_INT/D499_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D494_BIOP_INT/D494_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D495_BIOP_INT/D495_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D492_BIOP_INT/D492_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D490_BIOP_INT/D490_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D496_BIOP_INT/D496_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D534_BIOP_INT/D534_BIOP_INT_isomatrix.h5ad was successfully written to disk.
    File /data/analysis/data_mcandrew/000-sclr-discovair/D492_BIOP_NAS/D492_BIOP_NAS_isomatrix.h5ad was successfully written to disk.

``` python
andata_concat = concatenate_anndata(converted_isomatrix_paths, sparse = True)
```

    Standardizing anndata features via union: 100%|██████████| 14/14 [09:56<00:00, 42.57s/it]
    /home/mcandrew/.conda/envs/scLRanalyis/lib/python3.11/site-packages/anndata/_core/anndata.py:1897: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
      utils.warn_names_duplicates("obs")

``` python
andata_concat
```

``` python
andata_concat.var
```

``` python
concatenate_anndata.write_h5ad('discovair_long_read_transcript_matrix')
```
